<form [formGroup]="form" (ngSubmit)="create()">
  <div class="row default_center">
    <div class="col medium_8">
      <div class="row default_center">
        <div class="col">
          
          <h1 class="section_title text_center">Create new photo</h1>
    
          <div class="dropbox_outer input_wrapper">

            <div class="dropbox" *ngIf="!imagePreview || form.get('image').errors?.invalidMimeType"  [ngClass]="onDragover ? 'active' : ''">
              <span>Drag and drop an image or select "Add image"</span>
              <input type="file"id="filePicker" (change)="onImagePicked($event)" (dragover)="dragOver($event)" (dragleave)="dragLeave($event)">
            </div>
            <label class="btn" for="filePicker" *ngIf="!imagePreview || form.get('image').errors?.invalidMimeType">Add image</label>
            
            <div class="image-preview" *ngIf="imagePreview !== '' && imagePreview && !form.get('image').errors?.invalidMimeType">
              <img [src]="imagePreview" [alt]="form.value.title">
            </div>
            <button class="btn btn_danger" *ngIf="imagePreview !== '' && imagePreview && !form.get('image').errors?.invalidMimeType" (click)="onRemoveImage()">Remove image</button>
            
            <div class="errors" *ngIf="!form.get('image').valid">
              <span *ngIf="form.get('image').errors?.invalidMimeType">Image must be with format png, jpg or jpeg</span>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="input_wrapper required ">
            <label>Title: <span class="fas fa-exclamation-circle color_accent" *ngIf="!form.get('title').valid && form.get('title').touched"></span></label>
            <input type="text" placeholder="Enter Title" formControlName="title" />
            <div class="errors" *ngIf="!form.get('title').valid && form.get('title').touched">
              <span *ngIf="form.get('title').hasError('required')">Title is required</span>
              <span *ngIf="form.get('title').hasError('maxlength')">Title is too long</span>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="input_wrapper">
            <label>Description:</label>
            <textarea placeholder="Enter Description" formControlName="description" rows="5"></textarea>
            <div class="errors" *ngIf="!form.get('description').valid && form.get('description').touched">
              <span *ngIf="form.get('description').hasError('required')">Description is required</span>
              <span *ngIf="form.get('description').hasError('maxlength')">Description is too long</span>
            </div>
          </div>
        </div>
    
        <div class="col">
            
            <div formGroupName="categories" class="category_checkboxes row">
              <div class="col">
                <h3 class="section_title">Choose categories</h3>
                <div class="errors" *ngIf="!form.get('categories').valid && form.get('categories').touched">
                  <span *ngIf="form.get('categories').errors?.minLengthCategories">You must select at least one category</span>
                </div>
              </div>
              <div class="col large_4"  *ngFor="let category of form.controls.categories['controls']; let i = index">
                 
                <input 
                  type="checkbox" 
                  class="category_input" 
                  id="{{allCategories[i]._id}}"
                  [formControl]="category" 
                  (change)="getSelectedCategories(category, allCategories[i].title)" 
                > 
                <label class="category_label" for="{{allCategories[i]._id}}">
                  <img src="{{allCategories[i].imgUrl}}" alt="{{allCategories[i].title}}">
                  <div class="category_wrap">
                    <span class="custom_checkbox">
                      <span class="icon fas fa-check"></span>
                    </span>
                    <span class="category_title">{{allCategories[i].title}}</span>
                  </div>
                </label>
              </div>
            </div>
    
        </div>
        <div class="col medium_6 large_4">
          <button type="submit" class="btn wide" [disabled]="!form.valid">
            Create photo
          </button>
        </div>
    
      </div>
    </div>
  </div>
</form>